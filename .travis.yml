language: r
cache: packages
env:
  global:
    - ALLOWED_WARNINGS=0
    - ALLOWED_NOTES=0

# r_packages:
# #  - covr
#   - pkgdown

matrix:
  include:
  - r: devel
  # - r: release
  #   r_packages:
  #     - pkgdown
  #   # - covr
  #   deploy:
  #     provider: script
  #     script: Rscript -e 'pkgdown::deploy_site_github(verbose = TRUE)'
  #     skip_cleanup: true
  # - r: oldrel

script:
  - git config --global user.email "builds@travis-ci.com"
  - git config --global user.name "Travis CI"
  - export GIT_TAG=build-$TRAVIS_BRANCH-$(date -u "+%Y-%m-%d")-$TRAVIS_BUILD_NUMBER
  - echo -n $GIT_TAG > public/version
  - git commit -m "Set build VERSION number" public/version
  - git tag $GIT_TAG -a -m "Generated tag from TravisCI build $TRAVIS_BUILD_NUMBER"
  - git push git@github.com:jumpingrivers/inteRgrate.git $GIT_TAG
  # - Rscript -e 'devtools::install(".", upgrade = "never", build_vignettes = TRUE)'
  # - Rscript -e "inteRgrate::check_pkg(install = FALSE)"
  # - Rscript -e "inteRgrate::check_r_filenames()"
  # - Rscript -e "inteRgrate::check_tidy_description()"
  # - Rscript -e "inteRgrate::check_lintr()"
  # - Rscript -e "inteRgrate::check_namespace()"
  # - Rscript -e "inteRgrate::check_version()"

notifications:
  email:
    on_success: change
    on_failure: change


## Only run covr on release
#after_success:
#  - Rscript -e "if(length(grep('1\$', ${TRAVIS_JOB_NUMBER}))) covr::codecov()";



